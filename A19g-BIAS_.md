# נאיב בייס ב־NLP (למתחילים)
  
## מה אנחנו עושים פה?
  
אנחנו רוצים לסווג טקסטים – למשל:
- האם ביקורת לסרט היא חיובית או שלילית?
- האם מייל הוא ספאם או לא?
  
## מה הקשר לנוסחת בייס?
  
כמו שלמדנו קודם:
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(A|B)%20=%20\frac{P(B|A)%20\cdot%20P(A)}{P(B)}"/></p>  
  
  
עכשיו נשתמש בזה כדי לסווג טקסטים לפי מילים (tokens)
  
## איך זה נראה ב־NLP?
  
נסמן את הטקסט שלנו כקבוצה של מילים:
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?\mathbf{x}%20=%20(x_1,%20x_2,%20...,%20x_n)"/></p>  
  
  
כלומר: טקסט הוא פשוט אוסף של מילים כמו "good", "movie", "thrilling", וכו'
  
אנחנו רוצים לחשב:
מה ההסתברות שהטקסט שייך לקטגוריה מסוימת (למשל – חיובי), לפי המילים שבתוכו?
  
## הנוסחה החדשה (פשוטה):
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(C_k%20|%20\mathbf{x})%20\propto%20P(C_k)%20\cdot%20\prod_{i=1}^{n}%20P(x_i%20|%20C_k)"/></p>  
  
  
אל תיבהל! בוא נפרק:
  
- <img src="https://latex.codecogs.com/gif.latex?P(C_k%20|%20\mathbf{x})"/>: ההסתברות שהטקסט שייך לקטגוריה <img src="https://latex.codecogs.com/gif.latex?C_k"/> (למשל, חיובי)
- <img src="https://latex.codecogs.com/gif.latex?P(C_k)"/>: כמה פעמים הקטגוריה הזו הופיעה בעבר (למשל, כמה מהטקסטים בעבר היו חיוביים)
- <img src="https://latex.codecogs.com/gif.latex?P(x_i%20|%20C_k)"/>: כמה פעמים המילה <img src="https://latex.codecogs.com/gif.latex?x_i"/> הופיעה בטקסטים מקטגוריה <img src="https://latex.codecogs.com/gif.latex?C_k"/>
- <img src="https://latex.codecogs.com/gif.latex?\prod"/>: סימן כפל – נכפיל את כל ההסתברויות של המילים אחת אחרי השנייה
  
הסימן הזה <img src="https://latex.codecogs.com/gif.latex?\propto"/> אומר: "פרופורציונלי ל־".  
כלומר: זה לא הנוסחה המלאה עם המונה והמחנה – רק החלק החשוב שמשווה בין הקטגוריות
  
## מה עושים בפועל?
  
1. סופרים כמה טקסטים יש מכל קטגוריה → זה <img src="https://latex.codecogs.com/gif.latex?P(C_k)"/>
2. סופרים כמה פעמים כל מילה מופיעה בכל קטגוריה → זה <img src="https://latex.codecogs.com/gif.latex?P(x_i%20|%20C_k)"/>
3. מחלקים טקסט חדש למילים, מחשבים את ההסתברויות האלה עבור כל קטגוריה
4. בוחרים את הקטגוריה עם **ההסתברות הכי גבוהה**
  
## דוגמה פשוטה (בלי מתמטיקה):
  
- יש לנו טקסט: `"great movie"`
- המודל יודע שמילה "great" מופיעה רק בטקסטים חיוביים
- המודל מחשב שההסתברות שזה חיובי גבוהה יותר מהאפשרות שזה שלילי
- לכן הוא יסווג את הטקסט כ־**חיובי**
  
  
  
# נאיב בייס - הקדמה
  
## מהו Naive Bayes?
  
ה- **Naive Bayes** → מודל למידה מונחה (supervised) יעיל במיוחד, בעיקר בהקשר של עיבוד שפה טבעית (**NLP**). היעילות שלו נובעת מהפשטות והמהירות, מה שהופך אותו למתאים למשימות כמו:
- סיווג טקסטים
- זיהוי ספאם
- ניתוח סנטימנט (sentiment analysis)
- קטלוג מסמכים
  
ה- Naive Bayes הוא משפחה של מסווגים הסתברותיים פשוטים, המבוססים על יישום **נוסחת בייס**, תחת הנחה חזקה של **עצמאות תנאית** (כלומר, כל מאפיין בלתי תלוי באחרים בהינתן התוצאה)
  
## נוסחת בייס - Bayes' Theorem
  
ה- **Bayes' Theorem** → נוסחת בייס מחשבת את ההסתברות שאירוע חדש יתרחש, בהתבסס על הסתברויות של אירועים שהתרחשו בעבר.
  
### הסבר אינטואיטיבי
  
אם אנחנו יודעים מה ההסתברות של B כאשר A מתקיים, ומה ההסתברויות הבסיסיות של כל אחד מהאירועים, נוכל לחשב את ההסתברות ההפוכה – A בהינתן ש-Bהתרחש
  
**נוסחת בייס** היא נוסחה מתורת ההסתברות המאפשרת לחשב את ההסתברות של אירוע חדש בהינתן מידע קודם. הנוסחה היא:
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(A|B)%20=%20\frac{P(B|A)%20\cdot%20P(A)}{P(B)}"/></p>  
  
  
כאשר:
  
- P(A|B): ההסתברות שאירוע א קרה בהינתן ש-ב קרה
- P(B|A): ההסתברות ש-ב קורה בהינתן ש-א קרה
- P(A): ההסתברות הבסיסית שאירוע א יקרה
- P(B): ההסתברות הבסיסית שאירוע ב יקרה
  
### נאיב בייס - דוגמה פשוטה
  
#### תיאור התרחיש
  
נניח שאנחנו גרים בעיר בה בכל בניין יש מערכת גילוי עשן עצמאית. לפעמים המערכת נותנת אזעקת שווא – כלומר מזוהה עשן אך אין באמת שריפה (למשל, עשן מתנור)
  
#### נתונים ידועים:
- שריפות אמיתיות מתרחשות רק ב-1% מהמקרים → P(A) = 0.01
- אזעקות מופעלות ב-10% מהמקרים → P(B) = 0.1
- אזעקה מופעלת ב-95% ממקרי השריפה האמיתיים → P(B|A) = 0.95
  
#### השאלה
  
בהינתן שהאזעקה הופעלה, מה ההסתברות שיש באמת שריפה?
  
#### נאיב בייס - פתרון הדוגמה
  
**הגדרת האירועים:**
- פ- A: שריפה אמיתית
- פ- B: הופעלה אזעקת עשן
- פ- נדרש לחשב P(A|B)
  
 **שימוש בנוסחת בייס:**
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(A|B)%20=%20\frac{P(B|A)%20\cdot%20P(A)}{P(B)}%20=%20\frac{0.95%20\cdot%200.01}{0.1}%20=%20\frac{0.0095}{0.1}%20=%200.095"/></p>  
  
  
**תוצאה:**
ההסתברות שיש באמת שריפה כאשר האזעקה הופעלה היא **9.5%**
  
### דוגמא נוספת
  
#### תיאור התרחיש
  
בדיקה רפואית למחלה נדירה עם הנתונים הבאים:
  
- המחלה נדירה ומופיעה רק אצל 0.5% מהאוכלוסייה → P(A) = 0.005
- הבדיקה מזהה נכונה את המחלה ב-99% מהמקרים החיוביים → P(B|A) = 0.99
- הבדיקה נותנת חיובי שגוי ב-2% מהמקרים (לא חולים) → P(B| **not** A) = 0.02
  
#### שאלה:
מה ההסתברות שמישהו באמת חולה אם הבדיקה יצאה חיובית?
  
#### פתרון
  
**נתונים מהשאלה:**
  
- המחלה נדירה ומופיעה רק אצל 0.5% מהאוכלוסייה  
  → P(A) = 0.005
  לכן, הסתברות לא להיות חולה:  
  → P(**not** A) = 1 - 0.005 = 0.995  
- הבדיקה מזהה נכון את החולים ב־99% מהמקרים  
  → P(B|A) = 0.99
- הבדיקה נותנת חיובי שגוי ב־2% מהמקרים הבריאים  
  → P(B| **not** A) = 0.02
  
**מה נדרש לחשב?**
  
מה ההסתברות שאדם **באמת חולה**, בהינתן שהתוצאה של הבדיקה חיובית?
  
כלומר נחשב את:  
P(A|B) = ?
  
**שלב 1: חישוב הסתברות שהתוצאה חיובית P(B)**
  
כאן מציאת P(B) יותר מורכבת כי אנו יודעים רק את P(B| not A)
  
ראשית נגדיר הסתברות שאירוע לא קורה
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(\neg%20A)%20=%20**not**APropability"/></p>  
  
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(\neg%20A)%20=%201%20-%20P(A)"/></p>  
  
  
  
כעת נשתמש בכלל ההסתברות הכוללת:
  
הנוסחא מחשבת את ההסתברות הכוללת לכך שאירוע ב יקרה, גם אם איננו יודעים בוודאות האם א קרה או לא
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(B)%20=%20P(B|A)%20\cdot%20P(A)%20+%20P(B|\neg%20A)%20\cdot%20P(\neg%20A)"/></p>  
  
  
נציב את הערכים:
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(B)%20=%200.99%20\cdot%200.005%20+%200.02%20\cdot%200.995%20=%200.00495%20+%200.0199%20=%200.02485"/></p>  
  
  
**שלב 2: נציב הכל בנוסחת בייס**
  
<p align="center"><img src="https://latex.codecogs.com/gif.latex?P(A|B)%20=%20\frac{P(B|A)%20\cdot%20P(A)}{P(B)}%20=%20\frac{0.99%20\cdot%200.005}{0.02485}%20=%20\frac{0.00495}{0.02485}%20≈%200.199"/></p>  
  
  
**תוצאה סופית:**
  
**ההסתברות שאדם באמת חולה כאשר הבדיקה חיובית היא ≈ 19.9%**
  
#### מסקנה:
  
למרות שהבדיקה מאוד מדויקת, בגלל שהמחלה נדירה – רוב מי שמקבל תוצאה חיובית **לא באמת חולה**. זה מדגים עד כמה חשוב להבין את **הקשר בין שכיחות המחלה לבין אמינות הבדיקה**
  
  
  