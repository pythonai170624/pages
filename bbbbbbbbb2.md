# 🎩 SVM – גרעינים, Kernel Trick וטרנספורמציות

## מה זה Kernel (גרעין)?

Kernel הוא פונקציה מתמטית שמאפשרת ל־SVM לבצע הפרדה גם כאשר הנתונים **לא ניתנים להפרדה בקו ישר**.

במקום להפריד את הקבוצות במרחב המקורי, הקרנל:
- ממפה את הנתונים ל־**מרחב תכונות גבוה יותר**.
- במרחב החדש, ניתן להפריד את הקבוצות בקו ישר (Hyperplane).

ולכן – Kernel = טרנספורמציה חכמה + חישוב פנימי יעיל.

---

## מה זה טרנספורמציה (Transformation)?

טרנספורמציה היא פעולה מתמטית שמעבירה את הנתונים למרחב אחר (לרוב גבוה יותר) כדי שיהיה אפשר לבצע הפרדה ליניארית.

### דוגמה פשוטה:
ב־1D (על ציר X), אי אפשר להפריד בין:
- x = -2, -1, 0, 1, 2 (שליליים)
- x = 0 (חיובי)

נעשה טרנספורמציה:

$$
\phi(x) = x^2
$$

פתאום הנקודה החיובית (x=0) נשארת 0, והשליליות הופכות לגדולות יותר.
✅ עכשיו אפשר להפריד בין הקבוצות.

---

## Kernel Trick – מהו טריק הקרנל?

טריק הקרנל מאפשר לחשב את ההשפעה של טרנספורמציה **בלי באמת לבצע את הטרנספורמציה**.

במקום לחשב את:
$$
K(x, y) = \phi(x) \cdot \phi(y)
$$

אנחנו משתמשים ישירות ב־$K(x, y)$ — הקרנל, שמחזיר את הדמיון בין $x$ ל־$y$ במרחב החדש.

### יתרונות:
- חוסך חישובים וזיכרון
- מאפשר עבודה גם עם מרחבים בעלי אינסוף מימדים (למשל ב־RBF)
- מדויק ומהיר

---

## סוגי קרנלים נפוצים

### 1. Linear Kernel
$$
K(x, y) = x \cdot y
$$
- פשוט ומהיר
- עובד טוב כשיש הפרדה ליניארית

### 2. Polynomial Kernel
$$
K(x, y) = (\gamma x \cdot y + c)^d
$$
- $\gamma > 0$, $c \geq 0$, $d$ – דרגת הפולינום
- מתאים לבעיות עם קשרים מורכבים

### 3. RBF / Gaussian Kernel
$$
K(x, y) = \exp(-\gamma \|x - y\|^2)
$$
- מתאים לרוב סוגי הנתונים
- $\gamma$ שולט על "הטווח" של ההשפעה

### 4. Sigmoid Kernel
$$
K(x, y) = \tanh(\gamma x \cdot y + c)
$$
- מגיע מעולם הרשתות הנוירונים

---

## דוגמה חישובית לקרנלים

### Linear Kernel
- x = [1,2], y = [3,4]
- $K(x, y) = 1*3 + 2*4 = 11$

### Polynomial Kernel (d=2)
- $K(x, y) = (11 + 1)^2 = 144$

### RBF Kernel ($\gamma=0.5$)
- $\|x - y\|^2 = 8$
- $K(x, y) = \exp(-0.5 * 8) = \exp(-4) \approx 0.018$

---

## מה זה γ (Gamma)?

פרמטר חשוב מאוד בקרנלים לא־ליניאריים (בעיקר RBF):
- **ערך גבוה של γ** → השפעה ממוקדת מאוד לכל דוגמה
- **ערך נמוך של γ** → השפעה רחבה יותר, גבול החלטה חלק

---

## הדמיה ויזואלית של סוגי קרנלים

- **Linear**: קווים ישרים
- **Polynomial**: גבולות עקומים בהתאם לדרגת הפולינום
- **RBF**: אזורים מעוגלים סביב כל נקודה
- **Sigmoid**: דומה למבנה של נוירונים

---

## מתי להשתמש בכל קרנל?

| Kernel     | שימוש מועדף                                  |
|------------|-----------------------------------------------|
| Linear     | כשיש הפרדה ליניארית פשוטה                    |
| Polynomial | כשיש מבנה לא־ליניארי עם קשרים מתקדמים        |
| RBF        | ברירת מחדל – מתאים לרוב הבעיות               |
| Sigmoid    | במקרים דומים לרשתות נוירונים                 |

---

## סיכום

- Kernel = דרך חכמה לבצע טרנספורמציה ולהשוות בין דוגמאות
- Kernel Trick = לחשב את הדמיון בלי לבצע את הטרנספורמציה בפועל
- בחירה נכונה של קרנל ופרמטרים משפיעה מאוד על ביצועי ה־SVM

> המשך: דף 3 – יישומים בקוד, דוגמאות, GridSearchCV ועוד 🧪
