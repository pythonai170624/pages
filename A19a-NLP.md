## עיבוד שפה טבעית (NLP - Natural Language Processing)

<img src="nlp1.png" style="width: 30%" align="right"/>

עיבוד שפה טבעית הוא תחום בתוך אינטיליגנציה מלאכותית שמטרתו לגרום למחשב להבין שפה אנושית.  
המחשב לא רק קורא מילים אלא לומד את המשמעות וההקשר שלהן.  
עיבוד שפה טבעית מאפשר למחשב לזהות מבנה תחבירי, להבין משמעויות כפולות ולהגיב בהתאם להקשר.  
המטרה היא לגרום למחשב לנהל שיחה, לנתח טקסט או לתרגם שפה בצורה שדומה ליכולת אנושית.  
במקום שנכתוב קוד עם חוקים נוקשים, המחשב לומד מתוך טקסטים אמיתיים איך אנשים מדברים וכותבים.  
המערכת מסוגלת להבין האם משפט מסוים מביע רגש, כוונה או בקשה.  
היא גם יודעת להבחין בין שמות, פעלים, מקומות, מספרים ותאריכים.  
עיבוד שפה טבעית משמש כמעט בכל מערכת חכמה שצריכה להבין טקסט או דיבור

### רכיבי עיבוד שפה

**מורפולוגיה** – מבנה פנימי של מילים  

דוגמה: המילה "הולכים" בנויה מהשורש ה.ל.ך, עם תחילית "ה" וסיומת רבים "ים"

**תחביר (סינטקס)** – איך מילים מתחברות למשפט תקני  

דוגמה: במשפט "החתול רדף אחרי הכלב", התחביר מציין שהחתול הוא הנושא והכלב הוא המושא

**סמנטיקה** – משמעות המילים במשפט  

דוגמה: המילה "טיסה" יכולה להתכוון לפעולה של לטוס או למספר הטיסה – תלוי בהקשר

**פרגמטיקה** – משמעות לפי הקשר  

דוגמה: אם מישהו שואל "יש לך אש?" ברחוב – הוא כנראה מתכוון למצית ולא לאש פיזית


## שימושים נפוצים ב־NLP

* 🗣️ עוזרות קוליות כמו Siri ו־Alexa משתמשות ב־NLP להבנת פקודות  
* 💬 צ'אטבוטים עונים אוטומטית לשאלות  
* 🚫 סינון תוכן פוגעני ברשתות  
* 🏥 ניתוח רשומות רפואיות  
* 💰 תחום הפיננסים – ניתוח רגשות בטקסטים כמו חדשות או פוסטים ברשת לזיהוי מגמות שוק

## משימות עיקריות

✂️ טוקניזציה (Tokenization)  
פירוק משפטים למילים  
דוגמה: "אני אוהב NLP" → ["אני", "אוהב", "NLP"]

🏷️ תיוג תחבירי (POS Tagging)  
מציין מה סוג כל מילה – פועל, שם עצם, תואר וכו’  
דוגמה: במשפט "הילדה שרה שיר יפה"  
תקבל: הילדה = NOUN, שרה = VERB, שיר = NOUN, יפה = ADJ

🧠 זיהוי ישויות (NER)  
זיהוי שמות של אנשים, מקומות, ארגונים וסכומים  
דוגמה: "מיקרוסופט רכשה סטארטאפ בתל אביב ב־100 מיליון דולר"  
תקבל: מיקרוסופט = ORG, תל אביב = GPE, 100 מיליון דולר = MONEY

😊 ניתוח סנטימנט  
בדיקת הרגש בטקסט – שלילי, חיובי או נייטרלי  
דוגמה: "השירות היה מהיר ומעולה" → סנטימנט חיובי  
"דפקו אותי ממש היום" → סנטימנט שלילי

📝 סיכום טקסט  
יצירת תקציר ממסמך ארוך  
דוגמה: מתוך מאמר של 3 פסקאות על איכות סביבה, התקציר יהיה  
"המאמר מדגיש את החשיבות בצמצום פליטת גזי חממה ושמירה על משאבי טבע"


## אתגרים בעיבוד שפה

* 🌀 דו־משמעות – מילים עם פירושים שונים לפי הקשר  
* 😵 מורכבות השפה – שגיאות, סלנג, אירוניה  
* 🌍 חוסר דאטה לשפות נדירות

## ספריית spaCy

<img src="nlp2.png" align="right"/>

ספריית פייתון מהירה ומתקדמת לעיבוד שפה טבעית  
היא מתמקדת בביצועים גבוהים ובשימוש אמיתי בתעשייה – לא רק בניסויים אקדמיים

### 🚀 מה יש בה

* טוקניזציה חכמה שמתחשבת בסימני פיסוק, קיצורים ושפות שונות  
* תיוג תחבירי (POS Tagging) מדויק לפי מודלים מוכנים מראש  
* ניתוח תלות תחבירית (Dependency Parsing) – להבין את מבנה המשפט  
* זיהוי ישויות (NER) כמו שמות, מקומות, סכומים, תאריכים ועוד  
* למיטיזציה – המרת מילים לצורתן הבסיסית (goes → go)  
* תמיכה ב־**מודלים מוכנים מראש** בשפות שונות  
* יכולות התאמה חכמות כמו Phrase Matching  
* כלים לוויזואליזציה דרך `displaCy` להצגת מבנה תחבירי וישויות  
* עבודה חלקה עם TensorFlow, PyTorch ו־Keras

### 🤓 מה אין בה

* אין Stemming מובנה – בשביל זה צריך להשתמש ב־NLTK  
* פחות מתאימה ללמידת שפה מאפס – מיועדת בעיקר לשימוש מודלים קיימים

### 🧠 למה לבחור דווקא spaCy

* מאוד מהירה – גם על טקסטים ארוכים  
* נוחה לשימוש – כתיבה פשוטה ואינטואיטיבית  
* מדויקת – המודלים שלה נחשבים לאיכותיים מאוד  
* פתוחה לקסטומיזציה – אפשר להוסיף ישויות, כללים, מודלים משלך

💡 בקיצור – אם אתה רוצה לעבוד עם טקסט אמיתי בפייתון, מהר ובלי כאב ראש – spaCy זו הבחירה שלך


### יתרונות

* תומכת במודלים מוכנים מראש  
* פועלת עם PyTorch, TensorFlow ו־Keras  
* כוללת ויזואליזציה דרך displaCy

## התקנת spaCy

### שלבים

1. יצירת סביבה חדשה  
`!conda create -n spacy_env python=3.11 -y`

2. התקנת חבילת ipykernel  
`!conda install -n spacy_env ipykernel -y`  
`!python -m ipykernel install --user --name spacy_env --display-name "Python (spacy_env)"`

3. התקנת spaCy  
`!pip install spacy`

4. הורדת מודל שפה  
`!python -m spacy download en_core_web_sm`

💡 לעבור לסביבה החדשה דרך Kernel → Change kernel

## מודל שפה `en_core_web_sm`

* `en` – אנגלית  
* `core` – שימוש כללי  
* `web` – דאטה מהאינטרנט  
* `sm` – גרסה קלה ומהירה

### למה להשתמש במודל מוכן

* 🧠 מבצע משימות NLP מורכבות מראש  
* 💸 חוסך משאבים וזמן  
* 🚀 מאפשר התחלה מהירה לפרויקט

## דוגמת קוד ראשונית

```python
import spacy
nlp = spacy.load("en_core_web_sm")

doc = nlp("Apple is looking at buying U.K. startup for $1 billion")

for token in doc:
    print(token.text, token.pos_, token.dep_)
